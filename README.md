# Gradely Backend API

Welcome to the backend repository for **Gradely**, an automated grading and classroom management ecosystem.

This Django REST Framework (DRF) application serves as the core data engine for the Gradely platform. It handles user authentication, role-based access control (RBAC), classroom rostering, quiz management, and acts as the bridge between the Next.js frontend and the external Computer Vision Scanner API.

---

## General Purpose

Gradely is designed to streamline the grading workflow for educators. The backend is built as a headless REST API that fulfills the following primary purposes:

1. **Data Management:** Organizes complex relational data including Teachers, Subjects, Classrooms, Students, and Quizzes.
2. **Access Control:** Implements strict Role-Based Access Control (RBAC) ensuring Teachers only see their own classes, while Admins have a global view.
3. **Integration Hub:** Stores public URLs of processed Optical Mark Recognition (OMR) sheets (hosted on Supabase) generated by the external Scanner Microservice.
4. **Analytics & Reporting:** Computes dynamic quiz statistics (mean, max, min, item analysis) and generates downloadable CSV reports for offline record-keeping.

---

## Core Models

The database is built on PostgreSQL (or standard SQLite for local dev) and utilizes Django's ORM.

* **`User` (Custom)**: Extends the standard Django auth user.
* **`Subject`**: Represents academic courses (e.g., `code`, `name`, `grade_level`).
* **`Classroom`**: The central hub of a teacher's workflow, linking a `Subject` to a specific `Teacher` (User).
* **`Student`**: Represents an enrolled student with a unique `student_id` and `name`. Tied to Classrooms (allows for bulk importing via CSV/Excel).
* **`Quiz`**: Linked to a specific `Classroom`. Stores quiz metadata: `title`, `total_score`, and auto-calculated stats based on linked results.
* **`QuizResult`**: The junction between a `Quiz` and a `Student`. Stores the `score_obtained`, detailed `student_answers` (stored as JSON for item analysis), and the `scanned_image_url` linking to the visual proof of the graded OMR sheet on Supabase.

---

## External Integrations

While this is the main database API, it interacts with the following external services:

* **Gradely Scanner API (Hugging Face):** A Python OpenCV FastAPI microservice that processes raw images of bubble sheets, grades them against a dynamic key, uploads the annotated image, and returns the data payload to be saved via `QuizViewSet`.
* **Supabase Storage:** The backend stores public URLs generated by Supabase (e.g., `scanned_image_url`), allowing the Next.js frontend to securely display the scanned exams to teachers.

---

## Local Development Setup

### Prerequisites

* Python 3.10+
* PostgreSQL (Optional, if moving away from SQLite)
* `pip` and `virtualenv`

### Installation

1. **Clone the repository:**
```bash
git clone https://github.com/your-username/gradely-backend.git
cd gradely-backend

```


2. **Set up a virtual environment:**
```bash
python -m venv venv
source venv/bin/activate  # On Windows: venv\Scripts\activate

```


3. **Install dependencies:**
```bash
pip install -r requirements.txt

```


4. **Environment Variables:**
Create a `.env` file in the root directory (alongside `manage.py`) and add your variables:
```env
SECRET_KEY=your_django_secret_key
DEBUG=True
# Add database credentials if using PostgreSQL

```


5. **Run Migrations & Start Server:**
```bash
python manage.py makemigrations
python manage.py migrate
python manage.py runserver

```
